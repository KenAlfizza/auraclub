datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum RoleType {
  regular
  cashier
  manager
  superuser
}

enum TransactionType {
  purchase
  redemption
  adjustment
  event
  transfer
}

enum PromotionType {
  automatic
  onetime
}

model User {
  id          Int            @id @default(autoincrement())
  username    String 
  password    String?
  email       String         @unique
  utorid      String         @unique
  birthday    DateTime?
  role        RoleType       @default(regular)
  verified    Boolean        @default(false)
  loginToken  LoginToken?
  resetToken  ResetToken?

  createdAt   DateTime       @default(now())
}

model LoginToken {
  id        Int         @id @default(autoincrement())
  token     String
  createdAt DateTime    @default(now())
  expiresAt DateTime

  userId    Int         @unique
  user      User        @relation(fields: [userId], references:[id])
}

model ResetToken {
  id        Int         @id @default(autoincrement())
  token     String
  createdAt DateTime    @default(now())
  expiresAt DateTime
  used      Boolean     @default(false)

  userId    Int         @unique
  user      User        @relation(fields: [userId], references:[id])
}